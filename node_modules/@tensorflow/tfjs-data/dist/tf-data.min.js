/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@tensorflow/tfjs-core")):"function"==typeof define&&define.amd?define(["exports","@tensorflow/tfjs-core"],e):e((t.tf=t.tf||{},t.tf.data=t.tf.data||{}),t.tf)}(this,function(t,e){"use strict";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})}function o(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function a(t,e){return t(e={exports:{}},e.exports),e.exports}var c=a(function(t){!function(t,e,r){function n(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var r=new function(t){var e,r=this,n=(e=4022871197,function(t){t=t.toString();for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)});r.next=function(){var t=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1),n=null}(t),i=e&&e.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.alea=i}(0,t,!1)}),f=a(function(t){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var r=new function(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i}(0,t,!1)}),h=a(function(t){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i}(0,t,!1)}),l=a(function(t){!function(t,e,r){function n(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],r=(t^=t>>>7)^t<<24,r^=(t=n[i+1&7])^t>>>10,r^=(t=n[i+3&7])^t>>>3,r^=(t=n[i+4&7])^t<<7,t=n[i+7&7],r^=(t^=t<<13)^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&(i.x&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i}(0,t,!1)}),p=a(function(t){!function(t,e,r){function n(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,o=e.i;return e.w=n=n+1640531527|0,r=i[o+34&127],t=i[o=o+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[o]=r^t,e.i=o,r+(n^n>>>16)|0},function(t,e){var r,n,i,o,s,u=[],a=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,a=Math.max(a,e.length)),i=0,o=-32;o<a;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(s=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(s=s+1640531527|0,i=0==(r=u[127&o]^=n+s)?i+1:0);for(i>=128&&(u[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)n=u[i+34&127],r=u[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,u[i]=n^r;t.w=s,t.X=u,t.i=i}(e,t)}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&(i.X&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i}(0,t,!1)}),d=a(function(t){!function(t,e,r){function n(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i}(0,t,!1)}),y=a(function(t){!function(e,r){var n,i=(0,eval)("this"),o=256,s=6,u="random",a=r.pow(o,s),c=r.pow(2,52),f=2*c,h=o-1;function l(t,l,v){var m=[],w=d(function t(e,r){var n,i=[],o=typeof e;if(r&&"object"==o)for(n in e)try{i.push(t(e[n],r-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((l=1==l?{entropy:!0}:l||{}).entropy?[t,y(e)]:null==t?function(){try{var t;return n&&(t=n.randomBytes)?t=t(o):(t=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(t)),y(t)}catch(t){var r=i.navigator,s=r&&r.plugins;return[+new Date,i,s,i.screen,y(e)]}}():t,3),m),g=new function(t){var e,r=t.length,n=this,i=0,s=n.i=n.j=0,u=n.S=[];r||(t=[r++]);for(;i<o;)u[i]=i++;for(i=0;i<o;i++)u[i]=u[s=h&s+t[i%r]+(e=u[i])],u[s]=e;(n.g=function(t){for(var e,r=0,i=n.i,s=n.j,u=n.S;t--;)e=u[i=h&i+1],r=r*o+u[h&(u[i]=u[s=h&s+e])+(u[s]=e)];return n.i=i,n.j=s,r})(o)}(m),b=function(){for(var t=g.g(s),e=a,r=0;t<c;)t=(t+r)*o,e*=o,r=g.g(1);for(;t>=f;)t/=2,e/=2,r>>>=1;return(t+r)/e};return b.int32=function(){return 0|g.g(4)},b.quick=function(){return g.g(4)/4294967296},b.double=b,d(y(g.S),e),(l.pass||v||function(t,e,n,i){return i&&(i.S&&p(i,g),t.state=function(){return p(g,{})}),n?(r[u]=t,e):t})(b,w,"global"in l?l.global:this==r,l.state)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){for(var r,n=t+"",i=0;i<n.length;)e[h&i]=h&(r^=19*e[h&i])+n.charCodeAt(i++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(r["seed"+u]=l,d(r.random(),e),t.exports){t.exports=l;try{n=require("crypto")}catch(t){}}else 0}([],Math)});y.alea=c,y.xor128=f,y.xorwow=h,y.xorshift7=l,y.xor4096=p,y.tychei=d;var v=y.alea,m=a(function(t,e){function r(t){for(var e=t.length,r=0,n=0;e>0;)n=Math.random()*e|0,r=t[--e],t[e]=t[n],t[n]=r}function n(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function i(t,e){if(void 0===e&&(e=[]),null==e&&(e=[]),Array.isArray(t)||c(t))for(var r=0;r<t.length;++r)i(t[r],e);else e.push(t);return e}function o(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function s(t){return t%1==0}function u(t,e){var r=e.length;return n((t=null==t?e.map(function(t,e){return e}):[].concat(t)).every(function(t){return t>=-r&&t<r}),function(){return"All values in axis param must be in range [-"+r+", "+r+") but got axis "+t}),n(t.every(function(t){return s(t)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(t){return t<0?r+t:t})}function a(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+e+" being uploaded contains "+n+".")}}function c(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function f(t){return"string"==typeof t||t instanceof String}function h(t){return"boolean"==typeof t}function l(t){return"number"==typeof t}function p(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}Object.defineProperty(e,"__esModule",{value:!0}),e.shuffle=r,e.clamp=function(t,e,r){return Math.max(t,Math.min(e,r))},e.nearestLargerEven=function(t){return t%2==0?t:t+1},e.sum=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e},e.randUniform=function(t,e){var r=Math.random();return e*r+(1-r)*t},e.distSquared=function(t,e){for(var r=0,n=0;n<t.length;n++){var i=Number(t[n])-Number(e[n]);r+=i*i}return r},e.assert=n,e.assertShapesMatch=function(t,e,r){void 0===r&&(r=""),n(o(t,e),function(){return r+" Shapes "+t+" and "+e+" must match"})},e.assertNonNull=function(t){n(null!=t,function(){return"The input to the tensor constructor must be a non-null value."})},e.flatten=i,e.sizeFromShape=function(t){if(0===t.length)return 1;for(var e=t[0],r=1;r<t.length;r++)e*=t[r];return e},e.isScalarShape=function(t){return 0===t.length},e.arraysEqual=o,e.isInt=s,e.tanh=function(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)},e.sizeToSquarishShape=function(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]},e.createShuffledIndices=function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return r(e),e},e.rightPad=function(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)},e.repeatedTry=function(t,e,r){return void 0===e&&(e=function(t){return 0}),new Promise(function(n,i){var o=0,s=function(){if(t())n();else{var u=e(++o);null!=r&&o>=r?i():setTimeout(s,u)}};s()})},e.inferFromImplicitShape=function(t,e){for(var r=1,n=-1,i=0;i<t.length;++i)if(t[i]>=0)r*=t[i];else if(-1===t[i]){if(-1!==n)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+i);n=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===n){if(e>0&&e!==r)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===r)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%r!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+r);var o=t.slice();return o[n]=e/r,o},e.parseAxisParam=u,e.squeezeShape=function(t,e){for(var r=[],n=[],i=null==e?null:u(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===t[s]&&(r.push(t[s]),n.push(s)),i[o]<=s&&o++}1!==t[s]&&(r.push(t[s]),n.push(s))}return{newShape:r,keptDims:n}},e.getTypedArrayFromDType=function(t,e){var r=null;if(null==t||"float32"===t)r=new Float32Array(e);else if("int32"===t)r=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);r=new Uint8Array(e)}return r},e.getArrayFromDType=function(t,e){var r=null;if(null==t||"float32"===t)r=new Float32Array(e);else if("int32"===t)r=new Int32Array(e);else if("bool"===t)r=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);r=new Array(e)}return r},e.checkComputationForErrors=function(t,e,r){if("float32"===e)for(var n=0;n<t.length;n++){var i=t[n];if(isNaN(i)||!isFinite(i))throw Error("The result of the '"+r+"' is "+i+".")}},e.checkConversionForErrors=a,e.hasEncodingLoss=function(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)},e.isTypedArray=c,e.bytesPerElement=function(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)},e.bytesFromStringArray=function(t){if(null==t)return 0;var e=0;return t.forEach(function(t){return e+=2*t.length}),e},e.isString=f,e.isBoolean=h,e.isNumber=l,e.inferDtype=function t(e){return Array.isArray(e)?t(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":l(e)?"float32":f(e)?"string":h(e)?"bool":"float32"},e.isFunction=function(t){return!!(t&&t.constructor&&t.call&&t.apply)},e.nearestDivisor=function(t,e){for(var r=e;r<t;++r)if(t%r==0)return r;return t},e.computeStrides=function(t){var e=t.length;if(e<2)return[];var r=new Array(e-1);r[e-2]=t[e-1];for(var n=e-3;n>=0;--n)r[n]=r[n+1]*t[n+1];return r},e.toTypedArray=function(t,e,r){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=i(t)),r&&a(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var n=new Uint8Array(t.length),o=0;o<n.length;++o)0!==Math.round(t[o])&&(n[o]=1);return n}throw new Error("Unknown data type "+e)},e.toNestedArray=function(t,e){if(0===t.length)return e[0];var r=t.reduce(function(t,e){return t*e});if(0===r)return[];if(r!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,r,n){var i=new Array;if(1===r.length)for(var o=r[0],s=0;s<o;s++)i[s]=n[e+s];else{o=r[0];var u=r.slice(1),a=u.reduce(function(t,e){return t*e});for(s=0;s<o;s++)i[s]=t(e+s*a,u,n)}return i}(0,t,e)},e.makeOnesTypedArray=function(t,e){for(var r=p(t,e),n=0;n<r.length;n++)r[n]=1;return r},e.makeZerosTypedArray=p,e.now=function(){if("undefined"!=typeof performance)return performance.now();if("undefined"!=typeof process){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}throw new Error("Cannot measure time in this environment. You should run tf.js in the browser or in Node.js")},e.assertNonNegativeIntegerDimensions=function(t){t.forEach(function(e){n(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}});u(m);m.shuffle,m.clamp,m.nearestLargerEven,m.sum,m.randUniform,m.distSquared,m.assert,m.assertShapesMatch,m.assertNonNull,m.flatten,m.sizeFromShape,m.isScalarShape,m.arraysEqual,m.isInt,m.tanh,m.sizeToSquarishShape,m.createShuffledIndices,m.rightPad,m.repeatedTry,m.inferFromImplicitShape,m.parseAxisParam,m.squeezeShape,m.getTypedArrayFromDType,m.getArrayFromDType,m.checkComputationForErrors,m.checkConversionForErrors,m.hasEncodingLoss;var w=m.isTypedArray,g=(m.bytesPerElement,m.bytesFromStringArray,m.isString,m.isBoolean,m.isNumber,m.inferDtype,m.isFunction,m.nearestDivisor,m.computeStrides,m.toTypedArray,m.toNestedArray,m.makeOnesTypedArray,m.makeZerosTypedArray,m.now,m.assertNonNegativeIntegerDimensions,a(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=20,n=3,i=7;function o(t,e,r){var n;return n=Array.isArray(t)?parseFloat(t[0].toFixed(i))+" + "+parseFloat(t[1].toFixed(i))+"j":m.isString(t)?"'"+t+"'":"bool"===r?s(t):parseFloat(t.toFixed(i)).toString(),m.rightPad(n,e)}function s(t){return 0===t?"false":"true"}function u(t){for(var e=[],r=0;r<t.length;r+=2)e.push([t[r],t[r+1]]);return e}e.tensorToString=function(t,e,i,a){var c=m.computeStrides(e),f=function(t,e,r,n){var i=m.sizeFromShape(e),s=n[n.length-1],a=new Array(s).fill(0),c=e.length,f="complex64"===r?u(t):t;if(c>1)for(var h=0;h<i/s;h++)for(var l=h*s,p=0;p<s;p++)a[p]=Math.max(a[p],o(f[l+p],0,r).length);return a}(t,e,i,c),h=e.length,l=function t(e,i,a,c,f,h){void 0===h&&(h=!0);var l="complex64"===a?2:1,p=i[0],d=i.length;if(0===d){if("complex64"===a){var y=u(e);return[o(y[0],0,a)]}return"bool"===a?[s(e[0])]:[e[0].toString()]}if(1===d){if(p>r){var v=n*l,m=Array.from(e.slice(0,v)),w=Array.from(e.slice(p-n*l,p));return"complex64"===a&&(m=u(m),w=u(w)),["["+m.map(function(t,e){return o(t,f[e],a)}).join(", ")+", ..., "+w.map(function(t,e){return o(t,f[p-n+e],a)}).join(", ")+"]"]}var g="complex64"===a?u(e):Array.from(e);return["["+g.map(function(t,e){return o(t,f[e],a)}).join(", ")+"]"]}var b=i.slice(1),x=c.slice(1),D=c[0]*l,I=[];if(p>r){for(var S=0;S<n;S++){var E=S*D,A=E+D;I.push.apply(I,t(e.slice(E,A),b,a,x,f,!1))}I.push("...");for(var S=p-n;S<p;S++){var E=S*D,A=E+D;I.push.apply(I,t(e.slice(E,A),b,a,x,f,S===p-1))}}else for(var S=0;S<p;S++){var E=S*D,A=E+D;I.push.apply(I,t(e.slice(E,A),b,a,x,f,S===p-1))}var T=2===d?",":"";I[0]="["+I[0]+T;for(var S=1;S<I.length-1;S++)I[S]=" "+I[S]+T;for(var z=",\n",S=2;S<d;S++)z+="\n";return I[I.length-1]=" "+I[I.length-1]+"]"+(h?"":z),I}(t,e,i,c,f),p=["Tensor"];return a&&(p.push("  dtype: "+i),p.push("  rank: "+h),p.push("  shape: ["+e+"]"),p.push("  values:")),p.push(l.map(function(t){return"    "+t}).join("\n")),p.join("\n")}}));u(g);g.tensorToString;var b=a(function(t,e){var r,n=s&&s.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=s&&s.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})},o=s&&s.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=m,a=function(){function t(t,e,r){var n=this;if(this.dtype=e,this.shape=t.slice(),this.size=m.sizeFromShape(t),null!=r){var i=r.length;m.assert(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+n.size+"'."})}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||m.getArrayFromDType(e,this.size),this.strides=u.computeStrides(t)}return t.prototype.set=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];0===r.length&&(r=[0]),m.assert(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(r);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var r=t[t.length-1],n=0;n<t.length-1;++n)r+=this.strides[n]*t[n];return this.values[r]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return l.make(this.shape,{values:this.values},this.dtype)},t}();e.TensorBuffer=a;var c=null,f=null,h=null;e.setTensorTracker=function(t){c=t},e.setOpHandler=function(t){f=t},e.setDeprecationWarningFn=function(t){h=t};var l=function(){function t(t,e,r,n,i){this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=m.sizeFromShape(t),this.strides=u.computeStrides(t),this.dataId=null!=n?n:{},this.id=c().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",c().registerTensor(this,i),null!=r&&c().write(this.dataId,r)}return t.make=function(e,r,n,i){return new t(e,n,r.values,r.dataId,i)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),m.assert(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])},t.prototype.as4D=function(t,e,r,n){return this.throwIfDisposed(),this.reshape([t,e,r,n])},t.prototype.as5D=function(t,e,r,n,i){return this.throwIfDisposed(),this.reshape([t,e,r,n,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),f.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,f.buffer(this.shape,this.dtype,t)]}})})},t.prototype.bufferSync=function(){return f.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,u.toNestedArray(this.shape,t)]}})})},t.prototype.arraySync=function(){return u.toNestedArray(this.shape,this.dataSync())},t.prototype.data=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return this.throwIfDisposed(),[2,c().read(this.dataId)]})})},t.prototype.dataSync=function(){return this.throwIfDisposed(),c().readSync(this.dataId)},t.prototype.dispose=function(){this.isDisposed||(c().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),f.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),f.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),f.expandDims(this,t)},t.prototype.cumsum=function(t,e,r){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===r&&(r=!1),f.cumsum(this,t,e,r)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),f.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),f.clone(this)},t.prototype.oneHot=function(t,e,r){return this.throwIfDisposed(),f.oneHot(this,t,e,r)},t.prototype.toString=function(t){void 0===t&&(t=!1);var e=this.dataSync();return g.tensorToString(e,this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),f.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),f.gather(this,t,e)},t.prototype.matMul=function(t,e,r){return void 0===e&&(e=!1),void 0===r&&(r=!1),this.throwIfDisposed(),f.matMul(this,t,e,r)},t.prototype.dot=function(t){return this.throwIfDisposed(),f.dot(this,t)},t.prototype.norm=function(t,e,r){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===r&&(r=!1),this.throwIfDisposed(),f.norm(this,t,e,r)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),f.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),f.reverse(this,t)},t.prototype.concat=function(e,r){return void 0===r&&(r=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),f.concat([this].concat(e),r)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),f.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),f.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),f.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),f.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,r,n,i){return void 0===r&&(r=.001),h("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,n,r)},t.prototype.batchNorm=function(t,e,r,n,i){return void 0===i&&(i=.001),this.throwIfDisposed(),f.batchNorm(this,t,e,r,n,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),f.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),f.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),f.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),f.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),f.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),f.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),f.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),f.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),f.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),f.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),f.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),f.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),f.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),f.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),f.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),f.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),f.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),f.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),f.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),f.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),f.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),f.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),f.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),f.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),f.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),f.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),f.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),f.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),f.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),f.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),f.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),f.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),f.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),f.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),f.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),f.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),f.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),f.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),f.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),f.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),f.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),f.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),f.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),f.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),f.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),f.sign(this)},t.prototype.exp=function(){return this.throwIfDisposed(),f.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),f.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),f.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),f.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),f.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),f.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),f.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),f.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),f.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),f.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),f.relu(this)},t.prototype.elu=function(){return this.throwIfDisposed(),f.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),f.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),f.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),f.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),f.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),f.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),f.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),f.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),f.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),f.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),f.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),f.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),f.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),f.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),f.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),f.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),f.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),f.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),f.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),f.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),f.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),f.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),f.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),f.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),f.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),f.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),f.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),f.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,r,n,i,o){return void 0===n&&(n="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),f.conv1d(this,t,e,r,n,i,o)},t.prototype.conv2d=function(t,e,r,n,i,o){return void 0===n&&(n="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),f.conv2d(this,t,e,r,n,i,o)},t.prototype.conv2dTranspose=function(t,e,r,n,i){return this.throwIfDisposed(),f.conv2dTranspose(this,t,e,r,n,i)},t.prototype.depthwiseConv2D=function(t,e,r,n,i,o){return void 0===n&&(n="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),f.depthwiseConv2d(this,t,e,r,n,i,o)},t.prototype.separableConv2d=function(t,e,r,n,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),f.separableConv2d(this,t,e,r,n,i,o)},t.prototype.avgPool=function(t,e,r,n){return this.throwIfDisposed(),f.avgPool(this,t,e,r,n)},t.prototype.maxPool=function(t,e,r,n){return this.throwIfDisposed(),f.maxPool(this,t,e,r,n)},t.prototype.localResponseNormalization=function(t,e,r,n){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===r&&(r=1),void 0===n&&(n=.5),f.localResponseNormalization(this,t,e,r,n)},t.prototype.pool=function(t,e,r,n,i){return this.throwIfDisposed(),f.pool(this,t,e,r,n,i)},t.prototype.variable=function(t,e,r){return void 0===t&&(t=!0),this.throwIfDisposed(),p.variable(this,t,e,r)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),f.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),f.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),f.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),f.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,r,n,i,o,s,u){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),this.throwIfDisposed(),f.stridedSlice(this,t,e,r,n,i,o,s,u)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),f.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),f.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),f.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),f.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),f.spectral.irfft(this)},t}();e.Tensor=l,Object.defineProperty(l,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var p=function(t){function e(e,r,n){void 0===r&&(r=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=r,i.name=n,null==i.name&&(i.name=c().nextVariableId().toString());try{c().registerVariable(i)}catch(t){throw c().disposeTensor(i),t}return i}return n(e,t),e.variable=function(t,r,n,i){return void 0===r&&(r=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,r,n)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!m.arraysEqual(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");c().disposeTensor(this),this.dataId=t.dataId,c().registerTensor(this)},e}(l);e.Variable=p,Object.defineProperty(p,Symbol.hasInstance,{value:function(t){return t instanceof l&&null!=t.assign&&t.assign instanceof Function}});var d=p.variable;e.variable=d});u(b);b.TensorBuffer,b.setTensorTracker,b.setOpHandler,b.setDeprecationWarningFn,b.Tensor,b.Variable,b.variable;var x=a(function(t,e){var r,n,i,o;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(e.Rank||(e.Rank={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(n||(n={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(i||(i={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(o||(o={}));var s={float32:i,int32:r,bool:n,complex64:o};function u(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return s[t][e]}e.upcastType=u,e.sumOutType=function(t){return u(t,"int32")}});u(x);x.Rank,x.upcastType,x.sumOutType;var D=a(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.makeTypesMatch=function(t,e){if(t.dtype===e.dtype)return[t,e];var r=x.upcastType(t.dtype,e.dtype);return[t.cast(r),e.cast(r)]},e.assertTypesMatch=function(t,e){m.assert(t.dtype===e.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"})},e.isTensorInList=function(t,e){for(var r=0;r<e.length;r++)if(e[r].id===t.id)return!0;return!1},e.flattenNameArrayMap=function(t,e){var r=[];if(t instanceof b.Tensor)r.push(t);else for(var n=t,i=0;i<e.length;i++)r.push(n[e[i]]);return r},e.unflattenToNameArrayMap=function(t,e){if(t.length!==e.length)throw new Error("Cannot unflatten Tensor[], keys and arrays are not of same length.");for(var r={},n=0;n<t.length;n++)r[t[n]]=e[n];return r},e.getTensorsInContainer=function(t){var e=[];return function t(e,r,n){if(null!=e)if(e instanceof b.Tensor)r.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var s in o){var u=o[s];n.has(u)||(n.add(u),t(u,r,n))}}}(t,e,new Set),e}});u(D);D.makeTypesMatch,D.assertTypesMatch;var I=D.isTensorInList,S=(D.flattenNameArrayMap,D.unflattenToNameArrayMap,D.getTensorsInContainer),E=function(t){return t instanceof Buffer},A=a(function(t){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}),T=a(function(t){try{var e=z;if("function"!=typeof e.inherits)throw"";t.exports=e.inherits}catch(e){t.exports=A}}),z=a(function(t,e){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},n=0;n<e.length;n++)r[e[n]]=Object.getOwnPropertyDescriptor(t,e[n]);return r},n=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(s(arguments[r]));return e.join(" ")}r=1;for(var i=arguments,o=i.length,u=String(t).replace(n,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return t}}),a=i[r];r<o;a=i[++r])d(a)||!g(a)?u+=" "+a:u+=" "+s(a);return u},e.deprecate=function(t,r){if("undefined"!=typeof process&&!0===process.noDeprecation)return t;if("undefined"==typeof process)return function(){return e.deprecate(t,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return t.apply(this,arguments)}};var i,o={};function s(t,r){var n={seen:[],stylize:a};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(r)?n.showHidden=r:r&&e._extend(n,r),m(n.showHidden)&&(n.showHidden=!1),m(n.depth)&&(n.depth=2),m(n.colors)&&(n.colors=!1),m(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),c(n,t,n.depth)}function u(t,e){var r=s.styles[e];return r?"["+s.colors[r][0]+"m"+t+"["+s.colors[r][1]+"m":t}function a(t,e){return t}function c(t,r,n){if(t.customInspect&&r&&D(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return v(i)||(i=c(t,i,n)),i}var o=function(t,e){if(m(e))return t.stylize("undefined","undefined");if(v(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(y(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(d(e))return t.stylize("null","null")}(t,r);if(o)return o;var s=Object.keys(r),u=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(r)),x(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(r);if(0===s.length){if(D(r)){var a=r.name?": "+r.name:"";return t.stylize("[Function"+a+"]","special")}if(w(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(b(r))return t.stylize(Date.prototype.toString.call(r),"date");if(x(r))return f(r)}var g,I="",S=!1,E=["{","}"];(l(r)&&(S=!0,E=["[","]"]),D(r))&&(I=" [Function"+(r.name?": "+r.name:"")+"]");return w(r)&&(I=" "+RegExp.prototype.toString.call(r)),b(r)&&(I=" "+Date.prototype.toUTCString.call(r)),x(r)&&(I=" "+f(r)),0!==s.length||S&&0!=r.length?n<0?w(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),g=S?function(t,e,r,n,i){for(var o=[],s=0,u=e.length;s<u;++s)z(e,String(s))?o.push(h(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,r,n,i,!0))}),o}(t,r,n,u,s):s.map(function(e){return h(t,r,n,u,e,S)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(g,I,E)):E[0]+I+E[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,r,n,i,o){var s,u,a;if((a=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(u=t.stylize("[Setter]","special")),z(n,i)||(s="["+i+"]"),u||(t.seen.indexOf(a.value)<0?(u=d(r)?c(t,a.value,null):c(t,a.value,r-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),m(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function l(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function d(t){return null===t}function y(t){return"number"==typeof t}function v(t){return"string"==typeof t}function m(t){return void 0===t}function w(t){return g(t)&&"[object RegExp]"===I(t)}function g(t){return"object"==typeof t&&null!==t}function b(t){return g(t)&&"[object Date]"===I(t)}function x(t){return g(t)&&("[object Error]"===I(t)||t instanceof Error)}function D(t){return"function"==typeof t}function I(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(m(i)&&(i=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var r=process.pid;o[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else o[t]=function(){};return o[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=l,e.isBoolean=p,e.isNull=d,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=m,e.isRegExp=w,e.isObject=g,e.isDate=b,e.isError=x,e.isFunction=D,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=E;var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function z(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,r;console.log("%s - %s",(t=new Date,r=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":"),[t.getDate(),A[t.getMonth()],r].join(" ")),e.format.apply(e,arguments))},e.inherits=T,e._extend=function(t,e){if(!e||!g(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t};var N="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function k(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(N&&t[N]){var e;if("function"!=typeof(e=t[N]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,N,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,r,n=new Promise(function(t,n){e=t,r=n}),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push(function(t,n){t?r(t):e(n)});try{t.apply(this,i)}catch(t){r(t)}return n}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),N&&Object.defineProperty(e,N,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=N,e.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function e(){for(var e=[],r=0;r<arguments.length;r++)e.push(arguments[r]);var n=e.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return n.apply(i,arguments)};t.apply(this,e).then(function(t){process.nextTick(o,null,t)},function(t){process.nextTick(k,t,o)})}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,r(t)),e}}),N=(z.format,z.deprecate,z.debuglog,z.inspect,z.isArray,z.isBoolean,z.isNull,z.isNullOrUndefined,z.isNumber,z.isString,z.isSymbol,z.isUndefined,z.isRegExp,z.isObject,z.isDate,z.isError,z.isFunction,z.isPrimitive);z.isBuffer,z.log,z.inherits,z._extend,z.promisify,z.callbackify;function k(t,e,r,n){if(void 0===r&&(r=new Map),void 0===n&&(n=new Set),null==t)return null;if(n.has(t))throw new Error("Circular references are not supported.");if(r.has(t))return r.get(t);var i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(j(t)){var o=Array.isArray(t)?[]:{};for(var s in n.add(t),t){var u=k(t[s],e,r,n);o[s]=u}return n.delete(t),o}throw new Error("Can't recurse into non-iterable type: "+t)}return r.set(t,i.value),i.value}function O(t,e){return void 0===e&&(e=R),function t(e,r,n){void 0===n&&(n=new Set);var i=e[0];if(n.has(i))throw new Error("Circular references are not supported.");var o=r(e);if(o.recurse&&null!==o.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(o.recurse){if(j(i)){var s=Array.isArray(i)?[]:{};n.add(i);var u=function(i){var o=e.map(function(t){return t[i]}),u=t(o,r,n);s[i]=u};for(var a in i)u(a);return n.delete(i),s}throw new Error("Can't recurse into non-iterable type: "+i)}return o.value}(t,e)}function R(t){return null===t?null:j(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function C(t,e){return i(this,void 0,void 0,function(){var r,n,i,s,u,a;return o(this,function(o){switch(o.label){case 0:r=new Map,k(t,e,r),n=0,i=Array.from(r.keys()),o.label=1;case 1:return n<i.length?(s=i[n],(u=r.get(s))instanceof Promise?[4,u]:[3,3]):[3,4];case 2:a=o.sent(),r.set(s,a),o.label=3;case 3:return n++,[3,1];case 4:return[2,k(t,e,r)]}})})}function j(t){return null!=t&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof e.Tensor))}var F=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];this.push(n)}},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),r=this.get(e);return this.set(e,this.pop()),r},t}(),P=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return n(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=new Array(t),r=this.length(),n=0;n<r;n++)e[n]=this.get(this.wrap(this.begin+n));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r},e.INITIAL_CAPACITY=32,e}(F);function M(t){return new U(t)}function q(t){return new L(t)}var _,B=function(){function t(){}return t.prototype.toArray=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:return t=[],[4,this.next()];case 1:e=r.sent(),r.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=r.sent(),[3,2];case 4:return[2,t]}})})},t.prototype.toArrayForTest=function(){return i(this,void 0,void 0,function(){var t,e,r;return o(this,function(n){switch(n.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:r=n.sent(),n.label=2;case 2:return r.done?[3,4]:(e.push(r.value),[4,t.next()]);case 3:return r=n.sent(),[3,2];case 4:return[2,e]}})})},t.prototype.resolveFully=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}})})},t.prototype.resolveWhile=function(t){return i(this,void 0,void 0,function(){var e,r;return o(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:e=n.sent(),r=t(e.value),n.label=2;case 2:return e.done||!r?[3,4]:[4,this.next()];case 3:return e=n.sent(),r=t(e.value),[3,2];case 4:return[2]}})})},t.prototype.handleErrors=function(t){return new Q(this,t)},t.prototype.filter=function(t){return new X(this,t)},t.prototype.map=function(t){return new J(this,t)},t.prototype.mapAsync=function(t){return new Z(this,t)},t.prototype.serialMapAsync=function(t){return new Z(this,t).serial()},t.prototype.flatmap=function(t){return new Y(this,t)},t.prototype.forEachAsync=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,this.map(t).resolveFully()]})})},t.prototype.serialForEach=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,this.serialMapAsync(t).resolveWhile(function(t){return!0===t})]})})},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new G(this,t,e)},t.prototype.columnMajorBatch=function(t,e,r){return void 0===e&&(e=!0),void 0===r&&(r=R),this.rowMajorBatch(t,e).map(function(t){return O(t,r)})},t.prototype.concatenate=function(t,e){return new K(M([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new W(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new V(this,t)},t.prototype.prefetch=function(t){return new et(this,t)},t.prototype.shuffle=function(t,e){return new rt(this,t,e)},t.prototype.serial=function(){return new H(this)},t}(),U=function(t){function r(e){var r=t.call(this)||this;return r.items=e,r.trav=0,r}return n(r,t),r.prototype.summary=function(){return"Array of "+this.items.length+" items"},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t,r;return o(this,function(n){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],r=t instanceof e.Tensor?e.clone(t):t,this.trav++,[2,{value:r,done:!1}])})})},r}(B),L=function(t){function e(e){var r=t.call(this)||this;return r.nextFn=e,r}return n(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}return[2]})})},e}(B),H=function(t){function e(e){var r=t.call(this)||this;return r.upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.upstream.next()]})})},e}(B),V=function(t){function r(e,r){var n=t.call(this)||this;return n.upstream=e,n.maxCount=r,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return n(r,t),r.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},r.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=r.sent()).done?[2,t]:(e.dispose(t.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},r}(B),W=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.maxCount=r,n.count=0,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},e}(B),G=function(t){function e(e,r,n){void 0===n&&(n=!0);var i=t.call(this)||this;return i.upstream=e,i.batchSize=r,i.enableSmallLastBatch=n,i.lastRead=Promise.resolve({value:null,done:!1}),i}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:t=[],r.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=r.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}})})},e}(B),X=function(t){function r(e,r){var n=t.call(this)||this;return n.upstream=e,n.predicate=r,n.lastRead=Promise.resolve({value:null,done:!1}),n}return n(r,t),r.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},r.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(t=r.sent()).done||this.predicate(t.value)?[2,t]:(e.dispose(t.value),[3,0]);case 2:return[2]}})})},r}(B),J=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((t=o.sent()).done)return[2,{value:null,done:!0}];for(e=S(t.value),r=this.transform(t.value),n=S(r),i=0,s=e;i<s.length;i++)u=s[i],I(u,n)||u.dispose();return[2,{value:r,done:!1}]}})})},e}(B),Q=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.handler=r,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},e}(B),Z=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:return(t=o.sent()).done?[2,{value:null,done:!0}]:(e=S(t.value),[4,this.transform(t.value)]);case 2:for(r=o.sent(),n=S(r),i=0,s=e;i<s.length;i++)u=s[i],I(u,n)||u.dispose();return[2,{value:r,done:!1}]}})})},e}(B),$=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new P,e.lastRead=Promise.resolve({value:null,done:!1}),e}return n(e,t),e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},e}(B),Y=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((t=o.sent()).done)return[2,!1];for(e=S(t.value),r=this.transform(t.value),n=S(r),this.outputQueue.pushAll(r),i=0,s=e;i<s.length;i++)u=s[i],I(u,n)||u.dispose();return[2,!0]}})})},e}($),K=function(t){function e(e,r){var n=t.call(this)||this;return n.baseErrorHandler=r,n.lastRead=null,n.iterator=null,n.moreIterators=e,n}return n(e,t),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},e.prototype.readFromChain=function(t){return i(this,void 0,void 0,function(){var e,r;return o(this,function(n){switch(n.label){case 0:return[4,t];case 1:return n.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=n.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),n.label=3;case 3:return[4,this.iterator.next()];case 4:return(r=n.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,r]}})})},e}(B);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(_||(_={}));var tt=function(t){function e(e,r){void 0===r&&(r=_.FAIL);var n=t.call(this)||this;return n.iterators=e,n.mismatchMode=r,n.count=0,n.currentPromise=null,n}return n(e,t),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return i(this,void 0,void 0,function(){function e(t){return t instanceof B?{value:t.next().then(function(t){return r++,t.done&&n++,t.value}),recurse:!1}:{value:null,recurse:!0}}var r,n,i;return o(this,function(o){switch(o.label){case 0:return[4,t];case 1:return o.sent(),r=0,n=0,[4,C(this.iterators,e)];case 2:if(i=o.sent(),r===n)return[2,{value:null,done:!0}];if(n>0)switch(this.mismatchMode){case _.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case _.SHORTEST:return[2,{value:null,done:!0}];case _.LONGEST:}return this.count++,[2,{value:i,done:!1}]}})})},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.currentPromise=this.nextState(this.currentPromise),[4,this.currentPromise];case 1:return[2,t.sent()]}})})},e}(B),et=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.bufferSize=r,n.buffer=new F(r),n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(B),rt=function(t){function r(r,n,i){var o=t.call(this,r,n)||this;return o.upstream=r,o.windowSize=n,o.upstreamExhausted=!1,o.random=v(i||e.util.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return n(r,t),r.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},r.prototype.randomInt=function(t){return Math.floor(this.random()*t)},r.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},r.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:this.upstreamExhausted||this.refill(),r.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=r.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}})})},r}(et),nt=function(){function t(){this.size=null}return t.prototype.batch=function(t,r){var n=this;void 0===r&&(r=!0);var s=this;return e.util.assert(t>0,function(){return"batchSize needs to be positive, but it is\n      "+t}),it(function(){return i(n,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,s.iterator()];case 1:return[2,e.sent().columnMajorBatch(t,r,ot)]}})})},this.size===1/0||null==this.size?this.size:r?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,r=this;return it(function(){return i(e,void 0,void 0,function(){var e,n;return o(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return n=(e=i.sent()).concatenate,[4,t.iterator()];case 2:return[2,n.apply(e,[i.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var r=this,n=this;return it(function(){return i(r,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,n.iterator()];case 1:return[2,r.sent().filter(function(r){return e.tidy(function(){return t(r)})})]}})})},this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}})})},t.prototype.forEach=function(t){return i(this,void 0,void 0,function(){return o(this,function(r){return e.deprecationWarn("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},t.prototype.map=function(t){var r=this,n=this;return it(function(){return i(r,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,n.iterator()];case 1:return[2,r.sent().map(function(r){return e.tidy(function(){return t(r)})})]}})})},this.size)},t.prototype.mapAsync=function(t){var e=this,r=this;return it(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().mapAsync(t)]}})})},this.size)},t.prototype.prefetch=function(t){var e=this;if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return it(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().prefetch(t)]}})})},this.size)},t.prototype.repeat=function(t){var e=this,r=this;return it(function(){return i(e,void 0,void 0,function(){var e,n=this;return o(this,function(s){return e=q(function(){return i(n,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return t={},[4,r.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}})})}),[2,(u=e.take(t),new K(u,a))];var u,a})})},null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,r=this;return it(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().skip(t)]}})})},null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,r,n){var s=this;if(void 0===n&&(n=!0),null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var u=this,a=v(r||e.util.now().toString());return it(function(){return i(s,void 0,void 0,function(){var e;return o(this,function(r){switch(r.label){case 0:return e=a.int32(),n&&(e+=a.int32()),[4,u.iterator()];case 1:return[2,r.sent().shuffle(t,e.toString())]}})})},this.size)},t.prototype.take=function(t){var e=this,r=this;return it(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().take(t)]}})})},null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},t.prototype.toArrayForTest=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},t.MAX_BUFFER_SIZE=1e4,t}();function it(t,e){return void 0===e&&(e=null),new(function(r){function s(){var t=null!==r&&r.apply(this,arguments)||this;return t.size=e,t}return n(s,r),s.prototype.iterator=function(){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,t()]})})},s}(nt))}function ot(t){if(null===t)return null;var r,n=t[0];return null==(r=n)||N(r)||Array.isArray(r)||"object"==typeof r&&r instanceof e.Tensor||w(r)?{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof e.Tensor?e.stack(t):e.tensor(t)}(t),recurse:!1}:{value:null,recurse:!0}}var st=function(t){function e(e){var r=t.call(this)||this;return r.input=e,r}return n(e,t),e.prototype.iterator=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:return[4,this.input.iterator()];case 1:return t=r.sent(),e=t.decodeUTF8(),[2,e.split("\n")]}})})},e}(nt),ut=Symbol("out"),at=Symbol("field"),ct=Symbol("quote"),ft=Symbol("quoteafterquote"),ht=Symbol("quoteinquote"),lt=function(t){function r(e,r){var n=t.call(this)||this;return n.input=e,n.hasHeader=!0,n.fullColumnNames=null,n.columnNamesValidated=!1,n.columnConfigs=null,n.configuredColumnsOnly=!1,n.delimiter=",",n.base=new st(e),r||(r={}),n.hasHeader=!1!==r.hasHeader,n.fullColumnNames=r.columnNames,n.columnConfigs=r.columnConfigs,n.configuredColumnsOnly=r.configuredColumnsOnly,n.delimiter=r.delimiter?r.delimiter:",",n}return n(r,t),r.prototype.columnNames=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},r.prototype.setColumnNames=function(){return i(this,void 0,void 0,function(){var t,r,n,i,s,u,a=this;return o(this,function(o){switch(o.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=o.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&e.util.assert(t.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+a.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=t),r=this.fullColumnNames.reduce(function(t,e){return t[e]=t[e]+1||1,t},{}),n=Object.keys(r).filter(function(t){return r[t]>1}),e.util.assert(0===n.length,function(){return"Duplicate column names found: "+n.toString()}),this.columnConfigs)for(i=0,s=Object.keys(this.columnConfigs);i<s.length;i++)if(u=s[i],-1===this.fullColumnNames.indexOf(u))throw new Error('The key "'+u+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}})})},r.prototype.maybeReadHeaderLine=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,e.sent().next()];case 2:if((t=e.sent()).done)throw new Error("No data was found for CSV parsing.");return[2,t.value.split(this.delimiter)];case 3:return[2,null]}})})},r.prototype.iterator=function(){return i(this,void 0,void 0,function(){var t,e=this;return o(this,function(r){switch(r.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:r.sent(),r.label=2;case 2:return[4,this.base.iterator()];case 3:return t=r.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map(function(t){return e.makeDataElement(t)})]}})})},r.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),r={},n={},i=0;i<this.fullColumnNames.length;i++){var o=this.fullColumnNames[i],s=this.columnConfigs?this.columnConfigs[o]:null;if(!this.configuredColumnsOnly||s){var u=e[i],a=null;if(""===u)if(s&&void 0!==s.default)a=s.default;else{if(s&&(s.required||s.isLabel))throw new Error("Required column "+o+" is empty in this line: "+t);a=void 0}else{var c=Number(u);if(isNaN(c))a=s&&"bool"===s.dtype?this.getBoolean(u):u;else if(s&&s.dtype)switch(s.dtype){case"float32":a=c;break;case"int32":a=Math.floor(c);break;case"bool":a=this.getBoolean(u);break;default:a=c}else a=c}s&&s.isLabel?n[o]=a:r[o]=a}}return 0===Object.keys(n).length?r:{xs:r,ys:n}},r.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},r.prototype.parseRow=function(t){for(var e=[],r=0,n=t.length,i=at,o=0;o<n;o++)switch(i){case ut:switch(t.charAt(o)){case'"':r=o+1,i=ct;break;case this.delimiter:e.push(""),i=ut,r=o+1;break;default:i=at,r=o}break;case at:switch(t.charAt(o)){case this.delimiter:e.push(t.substring(r,o)),i=ut,r=o+1}break;case ct:switch(t.charAt(o)){case'"':i=ft}break;case ft:switch(t.charAt(o)){case this.delimiter:e.push(t.substring(r,o-1)),i=ut,r=o+1;break;case'"':i=ct;break;default:i=ht}break;case ht:switch(t.charAt(o)){case'"':i=ct}}return i===ft?e.push(t.substring(r,n-1)):e.push(t.substring(r)),e},r}(nt),pt=function(){return function(){}}(),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.split=function(t){return new yt(this,t)},e}(B),yt=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.impl=new vt(e,r),n}return n(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.impl.next()]})})},e}(dt),vt=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.separator=r,n.carryover="",n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((t=o.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((e=t.value.split(this.separator))[0]=this.carryover+e[0],r=0,n=e.slice(0,-1);r<n.length;r++)i=n[r],this.outputQueue.push(i);return this.carryover=e[e.length-1],[2,!0]}})})},e}($),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.decodeUTF8=function(){return new wt(this)},e}(B),wt=function(t){function e(e){var r=t.call(this)||this;return r.upstream=e,r.impl=new gt(e),r}return n(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.impl.next()]})})},e}(dt),gt=function(t){function r(r){var n=t.call(this)||this;if(n.upstream=r,e.ENV.get("IS_BROWSER"))n.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;n.decoder=new i("utf8")}return n}return n(r,t),r.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},r.prototype.pump=function(){return i(this,void 0,void 0,function(){var t,r,n;return o(this,function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:return(t=i.sent()).done?[2,!1]:(r=t.value,n=e.ENV.get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(n),[2,!0])}})})},r}($),bt=function(t){function r(r,n){void 0===n&&(n={});var i=t.call(this)||this;return i.file=r,i.options=n,e.util.assert(r instanceof Uint8Array||!!e.ENV.get("IS_BROWSER")&&(r instanceof File||r instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=n.offset||0,i.chunkSize=n.chunkSize||1048576,i}return n(r,t),r.prototype.summary=function(){return"FileChunks "+this.file},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t,e,r=this;return o(this,function(n){switch(n.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise(function(t,e){var n=r.offset+r.chunkSize;if(r.file instanceof Uint8Array)t(new Uint8Array(r.file.slice(r.offset,n)));else{var i=new FileReader;i.onload=function(r){var n=i.result;if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),!(n instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(n)},i.onabort=function(t){return e(new Error("Aborted"))},i.onerror=function(t){return e(new Error(t.type))};var o=r.file.slice(r.offset,n);i.readAsArrayBuffer(o)}r.offset=n}),e={},[4,t]);case 1:return[2,(e.value=n.sent(),e.done=!1,e)]}})})},r}(mt);function xt(t){return"string"==typeof t&&"file://"===t.substr(0,7)}var Dt=function(t){function r(e,r){void 0===r&&(r={});var n=t.call(this)||this;return n.input=e,n.options=r,n}return n(r,t),r.prototype.iterator=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(r){return xt(this.input)&&e.ENV.get("IS_NODE")&&(t=require("fs"),this.input=t.readFileSync(this.input.substr(7))),[2,new bt(this.input,this.options)]})})},r}(pt),It=function(t){function r(e,r){void 0===r&&(r={});var n=t.call(this)||this;return n.url=e,n.fileOptions=r,n}return n(r,t),r.prototype.iterator=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return xt(this.url)?[2,new Dt(this.url,this.fileOptions).iterator()]:[2,function(t,r){return void 0===r&&(r={}),i(this,void 0,void 0,function(){var n,i,s,u;return o(this,function(o){switch(o.label){case 0:return e.ENV.get("IS_BROWSER")?[4,fetch(t)]:[3,5];case 1:return(n=o.sent()).ok?[4,n.blob()]:[3,3];case 2:return i=o.sent(),[2,new bt(i,r)];case 3:throw new Error(n.statusText);case 4:return[3,9];case 5:if(s=require("node-fetch"),"string"!=typeof t)throw new Error("URL must be a string. Request objects are not supported in the node.js environment yet.");return[4,s(t)];case 6:return(n=o.sent()).ok?[4,n.buffer()]:[3,8];case 7:return u=o.sent(),[2,new bt(u,r)];case 8:throw new Error(n.statusText);case 9:return[2]}})})}(this.url,this.fileOptions)]})})},r}(pt);t.array=function(t){var e=this;return it(function(){return i(e,void 0,void 0,function(){return o(this,function(e){return[2,M(t)]})})},t.length)},t.Dataset=nt,t.zip=function(t){var e,r=this;if(!j(t))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(t))for(var n=0;n<t.length;n++)e=null==e?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(var s in t)e=null==e?t[s].size:Math.min(e,t[s].size);return it(function(){return i(r,void 0,void 0,function(){var e;return o(this,function(r){switch(r.label){case 0:return[4,C(t,function(t){if(t instanceof nt)return{value:t.iterator(),recurse:!1};if(j(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return e=r.sent(),[2,(n=e,i=_.SHORTEST,void 0===i&&(i=_.FAIL),new tt(n,i))]}var n,i})})},e)},t.CSVDataset=lt,t.TextLineDataset=st,t.csv=function(t,e){return void 0===e&&(e={}),new lt(new It(t),e)},t.func=function(t){var e=this,r=q(t);return it(function(){return i(e,void 0,void 0,function(){return o(this,function(t){return[2,r]})})})},t.generator=function(t){var e=this;return it(function(){return i(e,void 0,void 0,function(){var e;return o(this,function(r){switch(r.label){case 0:return[4,t()];case 1:return e=r.sent(),[2,q(function(){return e.next()})]}})})})},t.FileDataSource=Dt,t.URLDataSource=It,t.version_data="1.0.1",Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=tf-data.min.js.map
